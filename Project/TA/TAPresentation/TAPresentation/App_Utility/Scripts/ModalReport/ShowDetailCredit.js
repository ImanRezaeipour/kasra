var LastSelectedRow=null;var LastSelectedRowClass="";var CreditInfoDialogObj=null;var CreditState=0;window.name="ShowFirstCredit";aspnetForm.target="ShowFirstCredit";CheckParentAndLink();Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(BeginRequestHandler);Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);function BeginRequestHandler(b,a){if(document.getElementById(MasterObj+"txtMode").value!="link"){document.getElementById("OToolBar_ProgressBar").style.visibility="visible"}window.name="ShowFirstCredit";aspnetForm.target="ShowFirstCredit"}function EndRequestHandler(c,b){if(document.getElementById(MasterObj+"txtMode").value!="link"){document.getElementById("OToolBar_ProgressBar").style.visibility="hidden"}CheckParentAndLink();var a=$get(MasterObj+"txtSubmit").value;$get(MasterObj+"txtSubmit").value=""}function OnClickBtnCancel(){window.close()}function CheckParentAndLink(){var a=$get("GrdCreditDetail");if(a!=null){if(a.rows.length>0&&document.getElementById(MasterObj+"txtMode").value=="link"){$get(MasterObj+"DivPName").innerText=a.rows(1).cells(1).firstChild.innerText}a.rows(0).cells(0).style.display="none";a.rows(0).cells(1).style.display="none";a.rows(0).cells(6).style.display="none";for(var b=1;b<a.rows.length;b++){if(a.rows(b).cells(4).firstChild.innerText==""){a.rows(0).cells(4).style.display="none";a.rows(0).cells(5).style.display="none";a.rows(b).cells(4).style.display="none";a.rows(b).cells(5).style.display="none"}a.rows(b).cells(0).style.display="none";a.rows(b).cells(1).style.display="none";a.rows(b).cells(6).style.display="none"}}if(document.getElementById(MasterObj+"txtMode").value=="link"){document.getElementById(MasterObj+"TRInfo").style.display=document.getElementById(MasterObj+"txtParent").value=="0"?"none":"inline"}else{TRBase.bgColor="#D8E4F1"}}function RefreshDetailCredit(f){if(LastSelectedRow!=null){LastSelectedRow.className=LastSelectedRowClass}LastSelectedRowClass=f.className;LastSelectedRow=f.parentElement;f.parentElement.className="CssSelectedItemStyle";try{if(CreditState==1){if(CreditInfoDialogObj!=null){CreditInfoDialogObj.document.getElementById(MasterObj+"SDate").value=LastSelectedRow.cells(3).firstChild.innerText.split("/")[2]+"/"+LastSelectedRow.cells(3).firstChild.innerText.split("/")[1]+"/"+LastSelectedRow.cells(3).firstChild.innerText.split("/")[0];CreditInfoDialogObj.document.getElementById(MasterObj+"txtPersonCode").value=LastSelectedRow.cells(0).firstChild.innerText;CreditInfoDialogObj.document.getElementById(MasterObj+"txtGridID").value=LastSelectedRow.getAttribute("GridID");CreditInfoDialogObj.document.getElementById(MasterObj+"txtParent").value=LastSelectedRow.getAttribute("Parent");CreditInfoDialogObj.document.getElementById(MasterObj+"txtWPID").value=LastSelectedRow.getAttribute("WPID");CreditInfoDialogObj.document.getElementById(MasterObj+"txtCodeID").value=LastSelectedRow.getAttribute("CodeID");CreditInfoDialogObj.document.getElementById(MasterObj+"DivDate").innerText=LastSelectedRow.cells(3).firstChild.innerText;CreditInfoDialogObj.document.getElementById(MasterObj+"DivName").innerText=LastSelectedRow.cells(2).firstChild.innerText;CreditInfoDialogObj.document.getElementById(MasterObj+"DivPCode").innerText=LastSelectedRow.cells(0).firstChild.innerText;CreditInfoDialogObj.document.getElementById(MasterObj+"txtMode").value="link";CreditInfoDialogObj.onclickFilter()}}else{var c=LastSelectedRow.cells(0).firstChild.innerText;var b="ShowDetailCredit.aspx?PersonCode="+c+"&date="+LastSelectedRow.cells(3).firstChild.innerText.trim()+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&ToPersonId="+document.getElementById(MasterObj+"txtOnLineUser").value+"&Parent="+LastSelectedRow.getAttribute("Parent")+"&WPID="+LastSelectedRow.getAttribute("WPID")+"&CodeID="+LastSelectedRow.getAttribute("CodeID")+"&CodeName="+LastSelectedRow.cells(2).firstChild.innerText+"&Mode=link";var a="dialogWidth:750px;dialogHeight:550px;center: Yes;help: no;status:no;minimize: yes;";CreditState=1;CreditInfoDialogObj=window.showModelessDialog(encodeURI(b),window,a)}}catch(d){CreditState=0;OnClickDetailCredit()}}function OnClickDetailCredit(){if(LastSelectedRow!=null){var c=LastSelectedRow.cells(0).firstChild.innerText;var b="ShowDetailCredit.aspx?PersonCode="+c+"&date="+LastSelectedRow.cells(3).firstChild.innerText+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&ToPersonId="+document.getElementById(MasterObj+"txtOnLineUser").value+"&Parent="+LastSelectedRow.getAttribute("Parent")+"&WPID="+LastSelectedRow.getAttribute("WPID")+"&CodeID="+LastSelectedRow.getAttribute("CodeID")+"&CodeName="+LastSelectedRow.cells(2).firstChild.innerText+"&Mode=link";var a="dialogWidth:750px;dialogHeight:550px;center: Yes;help: no;status:no;minimize: yes;";CreditState=1;CreditInfoDialogObj=window.showModelessDialog(encodeURI(b),window,a)}}function onclickFilter(){document.getElementById(MasterObj+"txtSubmit").value="Filter";document.getElementById(MasterObj+"BtnSubmit").click()}function OnClickBtnFilter(){if($get(MasterObj+"CmbPerson_txtCode").value==""||$get(MasterObj+"CmbPerson_txtCode").value=="0"||document.getElementById(MasterObj+"CmbWP").value=="0"||$get(MasterObj+"CmbCode_txtCode").value==""||$get(MasterObj+"CmbCode_txtCode").value=="0"){alert("همه آيتم هاي فيلتر بايد انتخاب شوند")}else{document.getElementById(MasterObj+"txtPersonCode").value=$get(MasterObj+"CmbPerson_txtCode").value;document.getElementById(MasterObj+"txtParent").value=0;document.getElementById(MasterObj+"txtWPID").value=document.getElementById(MasterObj+"CmbWP").value;document.getElementById(MasterObj+"txtCodeID").value=$get(MasterObj+"CmbCode_txtCode").value;document.getElementById(MasterObj+"txtSubmit").value="Filter";document.getElementById(MasterObj+"BtnSubmit").click()}}function ShowCreditDetail(e){var a=e.parentElement.cells(3).firstChild.innerText;a="13"+a.split("/")[2]+"/"+a.split("/")[1]+"/"+a.split("/")[0];var d=e.parentElement.cells(0).firstChild.innerText;var c="../Reports/CreditInfo.aspx?PersonCode="+d+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&ToPersonId="+document.getElementById(MasterObj+"txtOnLineUser").value+"&PageMode=1&GrdHeight=480px&PersonName="+e.parentElement.cells(1).firstChild.innerText+"&SD="+a+"&ED="+a+"&Type="+e.parentElement.CodeID+"&GroupCode="+e.parentElement.Type+"&CreditID="+e.parentElement.CreditID;var b="dialogHeight: 550px;dialogWidth: 700px;Bottom:0pX;center: No;help: no;resizable:1;status: no;minimize: yes;";window.showModelessDialog(encodeURI(c),window,b)};