document.getElementsByTagName("body")[0].scroll="no";Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(BeginRequestHandler);Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);if(document.getElementById(MasterObj+"txtTableName").value!=""){onload()}function onload(){var a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML($get(MasterObj+"txtXmlRegisterDetail").value);var b;b=a.documentElement.selectNodes("/DataEntryEntity/RegisterDetail");$get("RadReplace").checked=b.item(0).selectSingleNode("Type").text.trim()=="R"?true:false;$get(MasterObj+"cmbPersonCode1_txtCode").value=b.item(0).selectSingleNode("FPersonelID").text;$get(MasterObj+"cmbPersonCode1_txtPCode").value=b.item(0).selectSingleNode("FPersonelID").text;$get(MasterObj+"cmbPersonCode1_txtName").value=b.item(0).selectSingleNode("DisplayName1").text;$get(MasterObj+"cmbPersonCode2_txtCode").value=b.item(0).selectSingleNode("SPersonelID").text;$get(MasterObj+"cmbPersonCode2_txtPCode").value=b.item(0).selectSingleNode("SPersonelID").text;$get(MasterObj+"cmbPersonCode2_txtName").value=b.item(0).selectSingleNode("DisplayName2").text;$get(MasterObj+"KCalSDate_txtDay").value=b.item(0).selectSingleNode("SDate").text.substr(0,2);$get(MasterObj+"KCalSDate_txtMonth").value=b.item(0).selectSingleNode("SDate").text.substr(3,2);$get(MasterObj+"KCalSDate_txtYear").value=b.item(0).selectSingleNode("SDate").text.substr(6,4);$get(MasterObj+"KCalSDate_txtCalendar").value=b.item(0).selectSingleNode("SDate").text;$get(MasterObj+"KCalSDate_txtCalendar").value=$get(MasterObj+"KCalSDate_txtCalendar").value+"  "+F_adbsghh($get(MasterObj+"KCalSDate_txtDay").value+"/"+$get(MasterObj+"KCalSDate_txtMonth").value+"/"+$get(MasterObj+"KCalSDate_txtYear").value);$get(MasterObj+"KCalEDate_txtDay").value=b.item(0).selectSingleNode("EDate").text.substr(0,2);$get(MasterObj+"KCalEDate_txtMonth").value=b.item(0).selectSingleNode("EDate").text.substr(3,2);$get(MasterObj+"KCalEDate_txtYear").value=b.item(0).selectSingleNode("EDate").text.substr(6,4);$get(MasterObj+"KCalEDate_txtCalendar").value=b.item(0).selectSingleNode("EDate").text;$get(MasterObj+"KCalEDate_txtCalendar").value=$get(MasterObj+"KCalEDate_txtCalendar").value+"  "+F_adbsghh($get(MasterObj+"KCalEDate_txtDay").value+"/"+$get(MasterObj+"KCalEDate_txtMonth").value+"/"+$get(MasterObj+"KCalEDate_txtYear").value);$get(MasterObj+"txtDesc").value=b.item(0).selectSingleNode("Desc").text;$get(MasterObj+"txtID").value=b.item(0).selectSingleNode("ID").text;if(b.item(0).selectSingleNode("Type").text&&b.item(0).selectSingleNode("Type").text==1){$get("RadChange").checked=true}else{$get("RadReplace").checked=true}if($get(MasterObj+"txtModifyFlag").value=="0"){$get("RadChange").disabled=true;$get("RadReplace").disabled=true;$get(MasterObj+"cmbPersonCode1_txtPCode").disabled=true;$get(MasterObj+"cmbPersonCode2_txtPCode").disabled=true;$get(MasterObj+"cmbPersonCode1_BtnDown").disabled=true;$get(MasterObj+"cmbPersonCode2_BtnDown").disabled=true;$get(MasterObj+"KCalSDate_txtCalendar").disabled=true;$get(MasterObj+"KCalSDate_btnImg").disabled=true;$get(MasterObj+"KCalEDate_txtCalendar").disabled=true;$get(MasterObj+"KCalEDate_btnImg").disabled=true;$get(MasterObj+"txtDesc").disabled=true;document.getElementById("OToolBar_BtnNew").style.visibility="hidden";document.getElementById("OToolBar_BtnSave").style.visibility="hidden";document.getElementById("OToolBar_BtnSaveNew").style.visibility="hidden"}}function OnClickBtnNew(){document.getElementById(MasterObj+"cmbPersonCode_txtCode").value="";document.getElementById(MasterObj+"cmbPersonCode_txtPCode").value="";document.getElementById(MasterObj+"cmbPersonCode_txtName").value="";document.getElementById(MasterObj+"KCalSDate_txtYear").value="";document.getElementById(MasterObj+"KCalSDate_txtMonth").value="";document.getElementById(MasterObj+"KCalSDate_txtDay").value="";document.getElementById(MasterObj+"KCalEDate_txtYear").value="";document.getElementById(MasterObj+"KCalEDate_txtMonth").value="";document.getElementById(MasterObj+"KCalEDate_txtDay").value="";$get(MasterObj+"KCalSDate_txtCalendar").value="";$get(MasterObj+"KCalEDate_txtCalendar").value="";document.getElementById(MasterObj+"txtDesc").value="";document.getElementById(MasterObj+"CmbStructure").value="0"}function BeginRequestHandler(b,a){document.getElementById("OToolBar_ProgressBar").style.visibility="visible";$get(MasterObj+"txtAlert").value=""}function EndRequestHandler(b,a){document.getElementById("OToolBar_ProgressBar").style.visibility="hidden";if($get(MasterObj+"txtAlert").value!=""){if($get(MasterObj+"txtValidate").value==0||$get(MasterObj+"txtValidate").value==""){alert($get(MasterObj+"txtAlert").value)}else{SetMsg($get(MasterObj+"txtAlert").value);window.returnValue=1}}if(Flag){OnClickBtnNew();Flag=false}$get(MasterObj+"txtAlert").value=""}function OnClickBtnNew(){document.getElementById(MasterObj+"txtID").value=0;document.getElementById(MasterObj+"cmbPersonCode1_txtCode").value="";document.getElementById(MasterObj+"cmbPersonCode1_txtPCode").value="";document.getElementById(MasterObj+"cmbPersonCode1_txtName").value="";document.getElementById(MasterObj+"cmbPersonCode2_txtCode").value="";document.getElementById(MasterObj+"cmbPersonCode2_txtPCode").value="";document.getElementById(MasterObj+"cmbPersonCode2_txtName").value="";document.getElementById(MasterObj+"KCalSDate_txtYear").value="";document.getElementById(MasterObj+"KCalSDate_txtMonth").value="";document.getElementById(MasterObj+"KCalSDate_txtDay").value="";$get(MasterObj+"KCalSDate_txtCalendar").value="";document.getElementById(MasterObj+"KCalEDate_txtYear").value="";document.getElementById(MasterObj+"KCalEDate_txtMonth").value="";document.getElementById(MasterObj+"KCalEDate_txtDay").value="";$get(MasterObj+"KCalEDate_txtCalendar").value="";document.getElementById(MasterObj+"txtDesc").value="";$get("RadChange").checked=true;document.getElementById(MasterObj+"txtType").value="R"}function chkIsEmpty(){var a=document.getElementById(MasterObj+"KCalSDate_txtYear").value+"/"+document.getElementById(MasterObj+"KCalSDate_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalSDate_txtDay").value;var b=document.getElementById(MasterObj+"KCalEDate_txtYear").value+"/"+document.getElementById(MasterObj+"KCalEDate_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalEDate_txtDay").value;if(document.getElementById(MasterObj+"cmbPersonCode1_txtCode").value==""){alert("لطفا پرسنل متقاضي را انتخاب کنید");$get(MasterObj+"cmbPersonCode1_txtPCode").focus()}else{if(document.getElementById(MasterObj+"cmbPersonCode2_txtCode").value==""){alert("لطفا پرسنل جانشين را انتخاب کنید");$get(MasterObj+"cmbPersonCode2_txtPCode").focus()}else{if(document.getElementById(MasterObj+"KCalSDate_txtYear").value==""||document.getElementById(MasterObj+"KCalSDate_txtMonth").value==""||document.getElementById(MasterObj+"KCalSDate_txtDay").value==""){alert("لطفا تاريخ شروع را وارد نماييد");$get(MasterObj+"KCalSDate_txtCalendar").focus()}else{if(document.getElementById(MasterObj+"KCalEDate_txtYear").value==""||document.getElementById(MasterObj+"KCalEDate_txtMonth").value==""||document.getElementById(MasterObj+"KCalEDate_txtDay").value==""){alert("لطفا تاريخ خاتمه را وارد نماييد");$get(MasterObj+"KCalEDate_txtCalendar").focus()}else{if(document.getElementById(MasterObj+"txtDesc").value==""){alert("لطفا شرح را وارد نماييد");$get(MasterObj+"txtDesc").focus()}else{if(a>b){alert("تاريخ شروع از خاتمه بزرگتر است");$get(MasterObj+"KCalSDate_txtCalendar").focus()}else{$get(MasterObj+"txtFPerson").value=document.getElementById(MasterObj+"cmbPersonCode1_txtCode").value;$get(MasterObj+"txtSPerson").value=document.getElementById(MasterObj+"cmbPersonCode2_txtCode").value;$get(MasterObj+"txtSDate").value=a;$get(MasterObj+"txtEDate").value=b;$get(MasterObj+"txtType").value=$get("RadChange").checked?"C":"R";return true}}}}}}}function OnClickBtnSave(){if(chkIsEmpty()){document.getElementById(MasterObj+"BtnSubmit").click()}}var Flag=false;function OnClickBtnSaveNew(){Flag=true;OnClickBtnSave()};