var SaveNewFlag=0;var SaveFlag=0;if(document.getElementById(MasterObj+"txtTableName").value!=""){onload()}Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(BeginRequestHandler);Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);function BeginRequestHandler(b,a){}function EndRequestHandler(b,a){if($get(MasterObj+"txtAlert").value!=""){if($get(MasterObj+"txtValidate").value==0||$get(MasterObj+"txtValidate").value==""){alert($get(MasterObj+"txtAlert").value)}else{SetMsg($get(MasterObj+"txtAlert").value);SaveFlag=1;window.returnValue=SaveFlag;if(SaveNewFlag==1){OnClickBtnNew()}}}$get(MasterObj+"txtSubmit").value="";$get(MasterObj+"txtAlert").value="";SaveNewFlag=0}function onload(){var a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML($get(MasterObj+"txtXmlRegisterDetail").value);var b;b=a.documentElement.selectNodes("/DataEntryEntity/RegisterDetail");$get(MasterObj+"cmbPersonCode_txtCode").value=b.item(0).selectSingleNode("PersonCode").text;$get(MasterObj+"cmbPersonCode_txtPCode").value=b.item(0).selectSingleNode("PersonCode").text;$get(MasterObj+"cmbPersonCode_txtName").value=b.item(0).selectSingleNode("DisplayName").text;$get(MasterObj+"KCalDate_txtDay").value=b.item(0).selectSingleNode("Date").text.substr(0,2);$get(MasterObj+"KCalDate_txtMonth").value=b.item(0).selectSingleNode("Date").text.substr(3,2);$get(MasterObj+"KCalDate_txtYear").value=b.item(0).selectSingleNode("Date").text.substr(6,4);$get(MasterObj+"KCalDate_txtCalendar").value=b.item(0).selectSingleNode("Date").text;$get(MasterObj+"KCalDate_txtCalendar").value=$get(MasterObj+"KCalDate_txtCalendar").value+"  "+F_adbsghh($get(MasterObj+"KCalDate_txtDay").value+"/"+$get(MasterObj+"KCalDate_txtMonth").value+"/"+$get(MasterObj+"KCalDate_txtYear").value);$get(MasterObj+"txtDesc").value=b.item(0).selectSingleNode("Description").text;$get(MasterObj+"cmbPersonCode_txtPCode").disabled=true;$get(MasterObj+"cmbPersonCode_BtnDown").disabled=true;document.getElementById("OToolBar_BtnNew").style.display="none";document.getElementById("OToolBar_BtnSaveNew").style.display="none";if($get(MasterObj+"txtModifyFlag").value=="0"){$get(MasterObj+"cmbPersonCode_txtPCode").disabled=true;$get(MasterObj+"cmbPersonCode_BtnDown").disabled=true;$get(MasterObj+"KCalDate_txtCalendar").disabled=true;$get(MasterObj+"txtDesc").disabled=true;document.getElementById("OToolBar_BtnNew").style.visibility="hidden";document.getElementById("OToolBar_BtnSave").style.visibility="hidden";document.getElementById("OToolBar_BtnSaveNew").style.visibility="hidden"}}function CmbPerson_onLoad(a,b){document.getElementById(MasterObj+"CmbPerson_Input").onkeydown=CmbPerson_Keydown}function CmbPerson_Keydown(){if(event.keyCode==13){if(document.getElementById(MasterObj+"CmbPerson_Input").value!=""){onKeyDownEnter($get(MasterObj+"CmbPeriod"))}else{$get(MasterObj+"CmbPerson_Input").focus()}}}function OnClickBtnNew(){$get(MasterObj+"cmbPersonCode_txtCode").value="";$get(MasterObj+"cmbPersonCode_txtPCode").value="";$get(MasterObj+"cmbPersonCode_txtName").value="";$get(MasterObj+"KCalDate_txtCalendar").value="";$get(MasterObj+"txtDesc").value="";$get(MasterObj+"txtScriptGroupXML").value="";$get(MasterObj+"txtFieldValue").value="0"}function chkIsEmpty(){var a=document.getElementById(MasterObj+"KCalDate_txtDay").value+"/"+document.getElementById(MasterObj+"KCalDate_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalDate_txtYear").value;if(($get(MasterObj+"cmbPersonCode_txtCode").value==""||$get(MasterObj+"cmbPersonCode_txtCode").value=="0")&&($get(MasterObj+"txtScriptGroupXML").value=="<Root></Root>"||$get(MasterObj+"txtScriptGroupXML").value==""||$get(MasterObj+"txtScriptGroupXML").value=="<Root/>")){alert("لطفا پرسنل مورد نظر خود را انتخاب نماييد");$get(MasterObj+"cmbPersonCode_txtPCode").focus()}else{if(document.getElementById(MasterObj+"KCalDate_txtYear").value==""||document.getElementById(MasterObj+"KCalDate_txtMonth").value==""||document.getElementById(MasterObj+"KCalDate_txtDay").value==""){alert("لطفا تاريخ  را وارد نماييد");$get(MasterObj+"KCalDate_txtCalendar").focus()}else{return true}}}function OnClickBtnSave(){if(chkIsEmpty()){document.getElementById(MasterObj+"txtPCode").value=document.getElementById(MasterObj+"cmbPersonCode_txtCode").value;document.getElementById(MasterObj+"txtKCalDate").value=document.getElementById(MasterObj+"KCalDate_txtYear").value+"/"+document.getElementById(MasterObj+"KCalDate_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalDate_txtDay").value;document.getElementById(MasterObj+"txtSubmit").value="Modify";document.getElementById(MasterObj+"BtnSubmit").click()}}function onKeyDownEnter(a){if(event.keyCode==13){switch(a.id){case MasterObj+"CmbPerson_Input":if(a.value!=""){onKeyDownEnter($get(MasterObj+"CmbPeriod"))}else{$get(MasterObj+"CmbPerson_Input").focus()}break;case MasterObj+"CmbPeriod":if(a.value!=""){onKeyDownEnter($get(MasterObj+"txtQuantity"))}else{$get(MasterObj+"CmbPeriod").focus()}break;case MasterObj+"txtQuantity":if(a.value!=""){onKeyDownEnter($get(MasterObj+"CmbMojavez"))}else{$get(MasterObj+"txtQuantity").focus()}break;case MasterObj+"CmbMojavez":if(a.value!=""){onKeyDownEnter($get(MasterObj+"txtDesc"))}else{$get(MasterObj+"CmbMojavez").focus()}break;case MasterObj+"txtDesc":OnClickBtnSave();break}}}function OnClickBtnSaveNew(){SaveNewFlag=1;OnClickBtnSave()}function OnClickBtnSelectGroup(){var b="CreditScriptGroup.aspx?ScriptID=0&ToPersonId="+$get(MasterObj+"txtOnLineUser").value+"&SessionID="+$get(MasterObj+"txtSessionID").value+"&CreditScriptGroup="+$get(MasterObj+"txtScriptGroupXML").value;b=encodeURI(b);var a=window.showModalDialog(b,"","dialogHeight: 400px;dialogWidth: 500px;center: Yes;help: no;status: no;scroll:no");$get(MasterObj+"txtScriptGroupXML").value=a};