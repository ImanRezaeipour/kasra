Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(BeginRequestHandler);Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);function BeginRequestHandler(b,a){document.getElementById("OToolBar_ProgressBar").style.visibility="visible"}function EndRequestHandler(c,b){document.getElementById("OToolBar_ProgressBar").style.visibility="Hidden";var a=$get(MasterObj+"txtSubmit").value;if(a=="Delete"){alert($get(MasterObj+"txtAlert").value)}}function RefreshParentRow(){var a=window.dialogArguments;if(a!=undefined&&typeof a.RefreshThisRow=="object"){a.RefreshThisRowCreditInfo()}}var ShowToolbar=0;var lastPersonCode=$get(MasterObj+"txtPersonCode").value,LastSelectedRow=null,LastSelectedRowClass="";PageLoad();function PageLoad(){if(typeof document.getElementById("OToolBar_BtnCancel")=="object"){if(document.getElementById("OToolBar_BtnCancel")!=null){document.getElementById("OToolBar_BtnCancel").style.display="none"}}if($get(MasterObj+"txtPageMode").value=="1"){document.getElementById("TDTopRow").style.display="none";document.getElementById("TDPersonInfo").style.display="inline";if(ShowToolbar==1){document.getElementById("TDToolbar").style.display="inline";if(typeof document.getElementById("OToolBar_BtnCancel")=="object"){if(document.getElementById("OToolBar_BtnCancel")!=null){document.getElementById("OToolBar_BtnCancel").style.display="none"}}else{if(typeof document.getElementById("OToolBar_BtnCancel")=="object"){if(document.getElementById("OToolBar_BtnCancel")!=null){document.getElementById("OToolBar_BtnCancel").style.display="inline"}}}}else{document.getElementById("TDToolbar").style.display="none"}}}function Pageunload(){window.opener.document.getElementById("CreditState").value=0}function OnClickBtnFilter(){var c=document.getElementById(MasterObj+"KCalSD_txtYear").value+"/"+document.getElementById(MasterObj+"KCalSD_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalSD_txtDay").value;if(c=="//"){c=""}var a=document.getElementById(MasterObj+"KCalED_txtYear").value+"/"+document.getElementById(MasterObj+"KCalED_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalED_txtDay").value;if(a=="//"){a=""}if(c==""||a==""){return}if(!compareDate()){return}var b="";if(document.getElementById(MasterObj+"CmbPersonelInfo_txtCode").value!=undefined){b=document.getElementById(MasterObj+"CmbPersonelInfo_txtCode").value.trim()}document.getElementById(MasterObj+"txtPersonCode").value=b;if(document.getElementById(MasterObj+"txtPersonCode").value==""&&(document.getElementById(MasterObj+"CmbPerson").value=="0"||document.getElementById(MasterObj+"CmbPerson").value=="")){return}document.getElementById(MasterObj+"txtSDate").value=c;document.getElementById(MasterObj+"txtEDate").value=a;$get(MasterObj+"txtSubmit").value="Filter";$get(MasterObj+"BtnSubmit").click()}function onClickImgRefreshPersonSearch(){var a="/Ta/TAPeresentation/Pages/Person/PersonTab.aspx?flag=Report &TypeAccess="+$get(MasterObj+"txtFlagAccess").value+" &MenuItemID=13129&SessionID="+$get(MasterObj+"txtSessionID").value;var e=window.showModalDialog(a,"","dialogWidth:800px;dialogHeight:750px;center: Yes;help: no;status:no");if(e!=""||e!=undefined){var b=new ActiveXObject("MsXml2.DomDocument");b.loadXML(e);b.setProperty("SelectionLanguage","XPath");var d;d=b.documentElement.selectNodes("/UserEntity/Person");if(d.length!=0){var c;c=d.item(0).selectSingleNode("PersonID").text;$get(MasterObj+"txtPersonCode").value=c;$get(MasterObj+"PersonNameSearch").value=d.item(0).selectSingleNode("Family").text}}}function OnBlurtxtPersonCode(){if($get(MasterObj+"txtPersonCode").value==""){$get(MasterObj+"PersonNameSearch").value="";lastPersonCode=""}else{if($get(MasterObj+"txtPersonCode").value!=lastPersonCode){lastPersonCode=$get(MasterObj+"txtPersonCode").value;$get(MasterObj+"BtnSubmit2").click()}}}function OnChangeCmbGroup(){var c=new ActiveXObject("Microsoft.XMLDOM");c.async="false";c.loadXML($get(MasterObj+"txtXMLCredite").value);var d;$get(MasterObj+"CmbType").innerHTML="";var a=0;if($get(MasterObj+"CmbGroup").value!=0&&$get(MasterObj+"CmbGroup").value!=""){d=c.documentElement.selectNodes("/GeneralEntity/LCombo[CodeGroupID="+$get(MasterObj+"CmbGroup").value+"]")}else{d=c.documentElement.selectNodes("/GeneralEntity/LCombo")}if(d.length!=0){if($get(MasterObj+"CmbGroup").value!=0){if(a==0){optionEl=document.createElement("OPTION");$get(MasterObj+"CmbType").options.add(optionEl);$get(MasterObj+"CmbType").all(a).innerText="انتخاب همه";$get(MasterObj+"CmbType").all(a).value="0";a++}}for(var b=0;b<d.length;++b){optionEl=document.createElement("OPTION");$get(MasterObj+"CmbType").options.add(optionEl);$get(MasterObj+"CmbType").all(a).innerText=d.item(b).selectSingleNode("CodeName").text;$get(MasterObj+"CmbType").all(a).value=d.item(b).selectSingleNode("CodeID").text;a++}}}function OnClickGrd(a){if(LastSelectedRow!=null){LastSelectedRow.className=LastSelectedRowClass}LastSelectedRowClass=a.className;LastSelectedRow=a;a.className="CssSelectedItemStyle"}function OnClickImgDel(b){var a=window.event.srcElement.parentElement;while(a.tagName!="TR"){a=a.parentElement}if(confirm("آیا برای حذف مطمئنید؟")==true){document.getElementById(MasterObj+"txtCreditID").value=a.getAttribute("CreditID");document.getElementById(MasterObj+"txtSubmit").value="Delete";document.getElementById(MasterObj+"BtnSubmit").click()}}function OnClickImgFlow(d){var a=window.event.srcElement.parentElement;while(a.tagName!="TR"){a=a.parentElement}var c=a.getAttribute("CreditID");var e=a.getAttribute("WFDocId");var b=a.getAttribute("DocTypeID");if(b==0&&e!=0){window.showModalDialog("/FrameWork/Pages/WorkFlow/CardTable/FlowDoc.aspx?WFDocId="+e+"&DocId="+c,"","dialogHeight: 450px;dialogWidth: 990px;center: Yes;help: no;status: no")}else{window.showModalDialog("/FrmPresentation/App_Pages/BaseInfo/WorkFlow/DocFlow.aspx?DocTypeID="+b+"&DocID="+c,"","dialogHeight: 450px;dialogWidth: 1400px;center: Yes;help: no;status: no")}}function compareDate(){var a=document.getElementById(MasterObj+"KCalED_txtYear").value+document.getElementById(MasterObj+"KCalED_txtMonth").value+document.getElementById(MasterObj+"KCalED_txtDay").value;var b=document.getElementById(MasterObj+"KCalSD_txtYear").value+document.getElementById(MasterObj+"KCalSD_txtMonth").value+document.getElementById(MasterObj+"KCalSD_txtDay").value;if(a<b){alert("تاريخ پايان بايد بزرگتر از تاريخ شروع باشد");return false}else{return true}}function OnClickBtnCancel(){window.close()};