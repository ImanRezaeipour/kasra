var LastSelectedRow=null;var LastSelectedRowClass="";var CreditState=0,CardexState=0;var win=null;var strChk="<Root></Root>";window.dir="RTL";if(typeof document.getElementById("OToolBar_ImgRestor")=="object"){if(document.getElementById("OToolBar_ImgRestor")!=null){document.getElementById("OToolBar_ImgRestor").style.display="none"}}if(typeof document.getElementById("OToolBar_BtnShowAll")=="object"){if(document.getElementById("OToolBar_BtnShowAll")!=null){document.getElementById("OToolBar_BtnShowAll").style.display="none"}}if(typeof document.getElementById("OToolBar_BtnSearch")=="object"){if(document.getElementById("OToolBar_BtnSearch")!=null){document.getElementById("OToolBar_BtnSearch").style.display="none"}}$get(MasterObj+"DivRole").innerText=$get(MasterObj+"txtDepartmentName").value;if(document.getElementById(MasterObj+"txtKind").value==""){document.getElementById("TBDailyRepot").style.display="inline";document.getElementById("TBAbsentPresent").style.display="none"}else{if(typeof document.getElementById("OToolBar_BtnFilter")=="object"){if(document.getElementById("OToolBar_BtnFilter")!=null){document.getElementById("OToolBar_BtnFilter").style.display="none"}}}document.body.attachEvent("onunload",Pageunload);PageLoad();SetSumRowColor();var arrColor={0:["lightgrey","روزهاي جمعه"],1:["#ffdfe7","تعطيلات رسمي"],2:["OldLace","کارت ناقصي"],3:["#E0C1FF","تغيير ساختار"],4:["#FFFFB7","مداومت کاري تائيد نشده"],5:["#37FF78","مداومت کاري تائيد شده"],6:["Red","مجوز وارد نشده"],7:["#ff33ff","بخشي از مجوز وارد شده"],8:["#009900","مجوز تائيد نشده"]};function PageLoad(){var I=document.getElementById(MasterObj+"GrdDailyReport");var D=0;if(I){D=I.rows.length-1}else{return}if(I!=null){I.rows(D-1).cells(0).innerText="سرجمع";I.rows(D-1).cells(1).innerText="";I.rows(D-1).cells(2).innerText=""}win=window.dialogArguments;var u=4,b=0,y=new String,q=0,a=0,E=0,j,t,w,l,k,s="",z="",v="",m=0,G,e,g,o,d,F="",f="",r="",B=0,c="",n;for(var A=1;A<D;A++){I.cellpadding="0";I.cellspacing="0";I.rows(A).style.margin=0;f=I.rows(A).InOutComplete;B=I.rows(A).UnCompletCard;r=I.rows(A).cells(4).innerText;k=f;a=0;if(f!=""){a=parseInt(getCntChar(";",f)+1);E=0;j="";t="";w=0;l=0;k=f;s="";z="";v="";m=0;G=0;e="";g=0;o=0;d="";F="";n="";for(;E<parseInt(u);++E){j=k.search(";");if(j=="-1"){j=k.length}t=k.substring(0,j);w=t.search(",");if(w=="-1"){w=t.length}l=t.substring(0,w);e=t.substring(parseInt(w)+1,t.length);g=e.search("/");o=e.substring(parseInt(g)+1,e.lenght);d="کارتخوان"+o;m=e.search("#");G=e.substring(parseInt(m)+1,e.lenght);e=e.substring(0,m);if(e!=""){if(parseInt(l)==1){n=G.split("/");if(parseInt(n[1])==1){G="";z="#009900";o=n[0];d="کارتخوان"+o;v=d}else{if(parseInt(n[1])==2){z="#ff0000";o=n[0];d="کارتخوان"+o;v=d}}}if(parseInt(l)==2){z="#ff33ff";v="مدير سيستم"}if(parseInt(l)==3){z="#FFFF00";v="کاربر"}if(r.length>=5){s+="&nbsp;&nbsp;<SPAN Width='50px' title='"+v+"'><font size='2px' color='"+z+"'> "+e+"</font></SPAN> "}else{s+="&nbsp;&nbsp;<SPAN Width='50px' title='"+v+"'><font size='2px' color='"+z+"'> "+e+"</font></SPAN> "}}k=k.substring(parseInt(j)+1,k.length)}var H="";if(ReplaceAll(I.rows(A).SInOut.trim()," ","")==ReplaceAll(r.trim()," ","")){H="<DIV width='100%' title='"+r+"'>"+s+"</Div>"}else{H="<DIV  width='100%' title='"+I.rows(A).SInOut+"'>"+s+"<font size='2px' color='"+z+"'>...</font></Div>"}I.rows(A).cells(4).innerHTML=H}if(I.rows(A).cells(4).firstChild.tagName=="SPAN"){I.rows(A).cells(4).firstChild.style.height="20px"}}}function SetSumRowColor(){var d=document.getElementById(MasterObj+"GrdDailyReport");var a,c=0;if(d){a=d.rows.length}else{return}while(d.rows(a-1).cells(c)){try{d.rows(a-1).className="";d.rows(a-1).className="CssSumItemStyle";d.rows(a-1).cells(c).className="CssSumItemStyle";d.rows(a-1).cells(c).firstChild.className="CssSumItemStyle"}catch(b){}c++}}function GetDateFromCal(){if(document.getElementById(MasterObj+"KCalSDate_txtYear").value==""||document.getElementById(MasterObj+"KCalSDate_txtMonth").value==""||document.getElementById(MasterObj+"KCalSDate_txtDay").value==""){alert("فرمت تاريخ شروع اشتباه است");return false}else{if(document.getElementById(MasterObj+"KCalEDate_txtYear").value==""||document.getElementById(MasterObj+"KCalEDate_txtMonth").value==""||document.getElementById(MasterObj+"KCalEDate_txtDay").value==""){alert("فرمت تاريخ خاتمه اشتباه است");return false}else{document.getElementById(MasterObj+"SDate").value=document.getElementById(MasterObj+"KCalSDate_txtYear").value+"/"+document.getElementById(MasterObj+"KCalSDate_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalSDate_txtDay").value;document.getElementById(MasterObj+"EDate").value=document.getElementById(MasterObj+"KCalEDate_txtYear").value+"/"+document.getElementById(MasterObj+"KCalEDate_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalEDate_txtDay").value;if(document.getElementById(MasterObj+"SDate").value>document.getElementById(MasterObj+"EDate").value){alert("تاريخ شروع از تاريخ خاتمه بزرگتر است ");return false}}}return true}function OnClickBtnFilter(){if(document.getElementById(MasterObj+"txtKind").value!=""){$get(MasterObj+"txtSubmit").value="Show";$get(MasterObj+"BtnSubmit").click()}else{OnClickBtnSearch()}}function OnClickBtnSearch(){if(GetDateFromCal()){$get(MasterObj+"txtPersonCodeSearch").value=document.getElementById(MasterObj+"CmbPerson_txtCode").value;$get(MasterObj+"txtSubmit").value="Show";$get(MasterObj+"BtnSubmit").click()}}function OnClickBtnShowAll(){if(GetDateFromCal()){document.getElementById(MasterObj+"CmbPerson_txtCode").value="";document.getElementById(MasterObj+"CmbPerson_txtName").value="";$get(MasterObj+"txtPersonCodeSearch").value="";$get(MasterObj+"txtSubmit").value="Show";$get(MasterObj+"BtnSubmit").click()}}function Pageunload(){if(document.getElementById(MasterObj+"txtKind").value==""){try{win.document.getElementById(MasterObj+"txtSubmit").value="Show";if(dialogArguments&&dialogArguments.DailyState){dialogArguments.DailyState=0}win.document.getElementById(MasterObj+"BtnSubmit").click()}catch(a){}}}function OnClickbtnCodeLimit(){var a="/TAPresentation/App_Pages/DataEntry/DefineLimitOnCode.aspx?ToPersonId="+$get(MasterObj+"txtOnLineUser").value+"&SessionID="+$get(MasterObj+"txtSessionID").value;a=encodeURI(a);window.showModalDialog(a,"","dialogHeight: 770px;dialogWidth:800px;center: Yes;help: no;status: no")}document.body.attachEvent("onkeydown",onkeydownBody);var keyCode=0;function onkeydownBody(){keyCode=event.keyCode;setTimeout("keyCode=0",1000)}function OnClickBtnCalc(){if(keyCode==16){document.getElementById(MasterObj+"txtRowDate").value=""}if(LastSelectedRow!=null){document.getElementById(MasterObj+"txtPersonCodeSearch").value=LastSelectedRow.cells(2).innerText;document.getElementById(MasterObj+"txtRowDate").value=LastSelectedRow.getAttribute("Rdate");document.getElementById(MasterObj+"txtSubmit").value="Calc";document.getElementById(MasterObj+"BtnSubmit").click()}else{alert("لطفا يک سطر گريد را انتخاب کنيد")}}function OnClickGrd(a){if(LastSelectedRow!=null){LastSelectedRow.className=LastSelectedRowClass}LastSelectedRowClass=a.className;LastSelectedRow=a;a.className="CssSelectedItemStyle";if(CreditState==1){RefreshCreditInfoPage()}}function OnClickbtnCardtable(){var b="";if($get(MasterObj+"txtNewWFO").value=="1"){b="/FrmPresentation/App_Pages/BaseInfo/WorkFlow/CartableNew.aspx"}else{b="../DataEntry/CreditManagement.aspx"}if(LastSelectedRow!=null){url=b+"?ToPersonId="+$get(MasterObj+"txtOnLineUser").value+"&SDate="+document.getElementById(MasterObj+"SDate").value+"&EDate="+document.getElementById(MasterObj+"EDate").value+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&PersonCode="+$get(MasterObj+"txtOnLineUser").value+"&Creator="+LastSelectedRow.cells(2).innerText+"&Flag=1";var a="dialogWidth:"+window.screen.width+";dialogHeight:630px;center: Yes;help: no;status:no#1;minimize: yes;resizable:yes";window.showModalDialog(url,window,a)}else{url=b+"?ToPersonId="+$get(MasterObj+"txtOnLineUser").value+"&SDate="+document.getElementById(MasterObj+"SDate").value+"&EDate="+document.getElementById(MasterObj+"EDate").value+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&PersonCode="+$get(MasterObj+"txtOnLineUser").value+"&Creator= &Flag=1";var a="dialogWidth:"+window.screen.width+";dialogHeight:630px;center: Yes;help: no;status:no#1;minimize: yes;resizable:yes";window.showModalDialog(url,window,a)}}function OnClickbtnCalendar(){if(LastSelectedRow!=null){var a="/Ta/TAPeresentation/Pages/SpecialCal/SpecialCal.aspx?GroupId=0&PersonId="+LastSelectedRow.cells(2).innerText+"&P=1&SDate="+document.getElementById(MasterObj+"SDate").value+"&ToPersonId="+document.getElementById(MasterObj+"txtOnLineUser").value+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value;window.showModalDialog(a,window,"dialogHeight: 680px;dialogWidth: 892px;center: Yes;help: no;status: no")}else{alert("لطفا يک سطر گريد را انتخاب کنيد")}}function OnClickbtnDefineGroup(){if(LastSelectedRow!=null){var a="/Ta/TAPeresentation/Pages/BaseInfo/Group/Group.aspx?flag=11&PersonId="+LastSelectedRow.getAttribute("personid");+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&PersonCode="+LastSelectedRow.cells(2).innerText}else{var a="/Ta/TAPeresentation/Pages/BaseInfo/Group/Group.aspx?flag=11&SessionID="+document.getElementById(MasterObj+"txtSessionID").value}var b=window.showModalDialog(a,window,"dialogHeight: 700px;dialogWidth: 800px;center: Yes;help: no;status: no")}function OnClickBtnRegCredit(){$get(MasterObj+"txtScriptGroupXML").value=strChk;if($get(MasterObj+"txtScriptGroupXML").value!="<Root></Root>"&&$get(MasterObj+"txtScriptGroupXML").value!="<Root/>"&&LastSelectedRow!=null){var a="../DataEntry/RegisterCredit.aspx?SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&PCode=&SDate="+LastSelectedRow.getAttribute("Rdate")+"&EDate="+LastSelectedRow.getAttribute("Rdate")+"&Name=&ToPersonId="+$get(MasterObj+"txtOnLineUser").value+"&CreditScriptGroup="+$get(MasterObj+"txtScriptGroupXML").value;var b=window.showModalDialog(encodeURI(a),window,"dialogHeight:550px;dialogWidth:700px;center: Yes;help: no;status: no")}else{if(LastSelectedRow!=null){var a="../DataEntry/RegisterCredit.aspx?SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&PCode="+LastSelectedRow.cells(2).innerText+"&SDate="+LastSelectedRow.getAttribute("Rdate")+"&EDate="+LastSelectedRow.getAttribute("Rdate")+"&Name="+LastSelectedRow.cells(3).innerText+"&ToPersonId="+$get(MasterObj+"txtOnLineUser").value+"&CreditScriptGroup="+document.getElementById(MasterObj+"txtScriptGroupXML").value;var b=window.showModalDialog(encodeURI(a),window,"dialogHeight:550px;dialogWidth:700px;center: Yes;help: no;status: no")}else{var a="../DataEntry/RegisterCredit.aspx?SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&PCode=&SDate="+$get(MasterObj+"SDate").value+"&EDate="+$get(MasterObj+"EDate").value+"&Name=&ToPersonId="+$get(MasterObj+"txtOnLineUser").value+"&CreditScriptGroup="+document.getElementById(MasterObj+"txtScriptGroupXML").value;var b=window.showModalDialog(encodeURI(a),window,"dialogHeight:550px;dialogWidth:700px;center: Yes;help: no;status: no")}}}function OnClickbtnDefinitionDayStructure(){url="/TAPresentation/App_Pages/Schedule/DefinitionDayStructure.aspx?ModalFlag=1&ToPersonId="+document.getElementById(MasterObj+"txtOnLineUser").value+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value;returnValue=window.showModalDialog(encodeURI(url),window,"dialogHeight: 550px;dialogWidth: 800px;center: Yes;help: no;status: no")}function OnClickbtnDefineٌWorkTimes(){var a="/Ta/TAPeresentation/Pages/BaseInfo/DefineWorkTimes.aspx?flag=11&SessionID="+document.getElementById(MasterObj+"txtSessionID").value;var b=window.showModalDialog(a,window,"dialogHeight: 750px;dialogWidth: 1000px;center: Yes;help: no;status: no")}function OnClickbtnReplaceChanges(){if(LastSelectedRow!=null){url="/Ta/TAPeresentation/Pages/BaseInfo/RplaceChanges.aspx?flag=11&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&PersonID="+LastSelectedRow.getAttribute("personid");+"&PersonCode="+$get(MasterObj+"CmbPerson_txtCode").value;returnValue=window.showModalDialog(url,window,"dialogHeight: 600px;dialogWidth: 900px;center: Yes;help: no;status: no")}else{alert("لطفا يک سطر گريد را انتخاب نماييد")}}function onClickInOutImg(){if(LastSelectedRow==null){alert("لطفا يک سطر از گريد انتخاب کنيد");return}var a=window.event.srcElement.parentElement;while(a.tagName!="TR"){a=a.parentElement}a=a.parentElement;while(a.tagName!="TR"){a=a.parentElement}var c=LastSelectedRow.getAttribute("personid");var d=LastSelectedRow.getAttribute("Rdate");var b="../DataEntry/Admin/GoingManage.aspx?PersonID="+c+"&ToPersonId="+document.getElementById(MasterObj+"txtOnLineUser").value+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&SDate="+document.getElementById(MasterObj+"SDate").value+"&EDate="+document.getElementById(MasterObj+"EDate").value;window.showModalDialog(b,window,"dialogHeight: 620px;dialogWidth: 1000px;center: Yes;help: no;status: no")}function OnClickBtnInOut(){onClickInOutImg()}var CreditInfoDialogObj=null;function OnClickBtnCreditInfo(){if(LastSelectedRow!=null){var c=LastSelectedRow.cells(2).innerText;var d=LastSelectedRow.getAttribute("Rdate");var b="CreditInfo.aspx?PersonCode="+c+" &SD="+d+" &ED="+d+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&ToPersonId="+document.getElementById(MasterObj+"txtOnLineUser").value+"&PageMode=1&GrdHeight=250px&PersonName="+LastSelectedRow.cells(3).innerText;var a="dialogHeight: 350px;dialogWidth: 700px;Bottom:0pX;center: No;help: no;status: no;minimize: yes;";CreditState=1;CreditInfoDialogObj=window.showModelessDialog(encodeURI(b),window,a)}else{alert("لطفا یک سطر از گرید انتخاب کنيد")}}function RefreshCreditInfoPage(){try{if(CreditInfoDialogObj){CreditInfoDialogObj.document.getElementById(MasterObj+"txtPersonCode").value=LastSelectedRow.cells(2).innerText;CreditInfoDialogObj.document.getElementById(MasterObj+"NameTD").innerHTML=LastSelectedRow.cells(3).innerText;CreditInfoDialogObj.document.getElementById(MasterObj+"PersonIDTD").innerHTML=LastSelectedRow.getAttribute("PersonCode");var d=LastSelectedRow.getAttribute("Rdate");var a=LastSelectedRow.getAttribute("Rdate");var b,f;b=d.substring(8,10)+"/"+a.substring(5,7)+"/"+a.substring(0,4);f=a.substring(8,10)+"/"+a.substring(5,7)+"/"+a.substring(0,4);CreditInfoDialogObj.document.getElementById(MasterObj+"KCalSD_txtCalendar").value=b+"  "+F_adbsghh(b);CreditInfoDialogObj.document.getElementById(MasterObj+"KCalED_txtCalendar").value=f+"  "+F_adbsghh(f);CreditInfoDialogObj.document.getElementById(MasterObj+"SDate").value=d;CreditInfoDialogObj.document.getElementById(MasterObj+"EDate").value=a;CreditInfoDialogObj.document.getElementById(MasterObj+"KCalSD_txtYear").value=d.substring(0,4);CreditInfoDialogObj.document.getElementById(MasterObj+"KCalSD_txtMonth").value=d.substring(5,7);CreditInfoDialogObj.document.getElementById(MasterObj+"KCalSD_txtDay").value=d.substring(8,10);CreditInfoDialogObj.document.getElementById(MasterObj+"KCalED_txtYear").value=a.substring(0,4);CreditInfoDialogObj.document.getElementById(MasterObj+"KCalED_txtMonth").value=a.substring(5,7);CreditInfoDialogObj.document.getElementById(MasterObj+"KCalED_txtDay").value=a.substring(8,10);CreditInfoDialogObj.document.getElementById(MasterObj+"CmbPersonelInfo_Input").value=$get(MasterObj+"CmbPerson_txtCode").value+"-"+$get(MasterObj+"CmbPerson_txtName").value;CreditInfoDialogObj.OnClickBtnFilter()}}catch(c){}}function OnClickBtnCardexInfo(){if(LastSelectedRow!=null){var d=LastSelectedRow.cells(2).innerText;var b=document.getElementById(MasterObj+"SDate").value.substring(6,7);var e="/FrmPresentation/App_Pages/FormGenerator/ReportShow.aspx?ToPersonId"+document.getElementById(MasterObj+"txtOnLineUser").value+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&PageMode=1&GrdHeight=250px&MenuItemID=34205&pid="+d+"&wpid="+b;var a="dialogHeight: 760px;dialogWidth: 950px;center: Yes;help: no;status: no";var c=window.showModalDialog(encodeURI(e),window,a)}else{alert("به منظور نمايش کاردکس يک سطر از گريد را انتخاب کنيد")}}var SelectRow=null;function RefreshThisRow(){SelectRow=window.event.srcElement.parentElement;while(SelectRow.tagName!="TR"){SelectRow=SelectRow.parentElement}document.getElementById(MasterObj+"txtRDate").value=SelectRow.getAttribute("Rdate");document.getElementById(MasterObj+"txtPersonCodeSearch").value=$get(MasterObj+"CmbPerson_txtCode").value;$get(MasterObj+"txtSubmit").value="RefreshRow";$get(MasterObj+"BtnSubmit2").click()}function RefreshThisRowCreditInfo(){SelectRow=LastSelectedRow;if(SelectRow==null){return}document.getElementById(MasterObj+"txtRDate").value=SelectRow.getAttribute("Rdate");document.getElementById(MasterObj+"txtPersonCodeSearch").value=$get(MasterObj+"CmbPerson_txtCode").value;$get(MasterObj+"txtSubmit").value="RefreshRow";$get(MasterObj+"BtnSubmit2").click()}function UpdateRow(){var A=document.getElementById(MasterObj+"txtXmlRowInfo").value;if(document.getElementById(MasterObj+"txtXmlRowInfo").value==""||document.getElementById(MasterObj+"txtXmlGridSetting").value==""){return}var t=new ActiveXObject("MsXml2.DomDocument");t.loadXML(document.getElementById(MasterObj+"txtXmlRowInfo").value);t.setProperty("SelectionLanguage","XPath");var K=t.documentElement.selectNodes("/ReportsEntity/RptGetPersonelDailyReport");var q=new ActiveXObject("MsXml2.DomDocument");q.loadXML(document.getElementById(MasterObj+"txtXmlGridSetting").value);q.setProperty("SelectionLanguage","XPath");var d=q.documentElement.selectNodes("/GeneralEntity/GridSetting[Attributable=0]");var n=d.length;if(K.length!=0){var a=document.getElementById(MasterObj+"GrdDailyReport");var L=4,H=new String,G=0,f=0,O=0,e,I,s,z,c,y="",B="",r="",j=0,Q,w,k,F,R,N="",D="",E="",b=0,o="";D=K.item(0).selectSingleNode("InOutComplete").text;b=K.item(0).selectSingleNode("UnCompletCard").text;E=K.item(0).selectSingleNode("InOut").text;c=D;f=0;if(D!=""){f=parseInt(getCntChar(";",D)+1);O=0;e="";I="";s=0;z=0;c=D;y="";B="";r="";j=0;Q=0;w="";k=0;F=0;R="";N="";var l;for(;O<parseInt(L);++O){e=c.search(";");if(e=="-1"){e=c.length}I=c.substring(0,e);s=I.search(",");if(s=="-1"){s=I.length}z=I.substring(0,s);w=I.substring(parseInt(s)+1,I.length);k=w.search("/");F=w.substring(parseInt(k)+1,w.lenght);R="کارتخوان"+F;j=w.search("#");Q=w.substring(parseInt(j)+1,w.lenght);w=w.substring(0,j);if(w!=""){if(parseInt(z)==1){l=Q.split("/");if(parseInt(l[1])==1){Q="";B="#009900";F=l[0];R="کارتخوان"+F;r=R}else{if(parseInt(l[1])==2){B="#ff0000";F=l[0];R="کارتخوان"+F;r=R}}}if(parseInt(z)==2){B="#ff33ff";r="مدير سيستم"}if(parseInt(z)==3){B="#FFFF00";r="کاربر"}if(E.length>=5){y+="&nbsp;&nbsp;<SPAN Width='50px' title='"+r+"'><font size='2px' color='"+B+"'> "+w+"</font></SPAN> "}else{y+="&nbsp;&nbsp;<SPAN Width='50px' title='"+r+"'><font size='2px' color='"+B+"'> "+w+"</font></SPAN> "}}c=c.substring(parseInt(e)+1,c.length)}var v="";if(K.item(0).selectSingleNode("SInOut").text.trim()==E.trim()){v="<Div width='100%' title='"+E+"'>"+y+"</Div>"}else{v="<Div  width='100%' title='"+K.item(0).selectSingleNode("SInOut").text+"'>"+y+"<font size='2px' color='"+B+"'>...</font></Div>"}SelectRow.cells(4).innerHTML=v}var g,m=a.rows.length-1,J=-1,u=-1;for(var M=3;M<n;M++){g=d.item(M).selectSingleNode("ColName").text;g=ReplaceAll(g," ","_");if(g=="حضور_غير_موظف_عادي_روزكاري"){u=M}else{if(g=="سرجمع_كسر_كار"){J=M}}if(t.selectSingleNode("/ReportsEntity/RptGetPersonelDailyReport/"+g)!=null){if(ReplaceAll(K.item(0).selectSingleNode(g).text," ","")==""){SelectRow.cells(M).style.textDecoration="none";SelectRow.cells(M).firstChild.style.textDecoration="none"}SelectRow.cells(M).firstChild.innerText=K.item(0).selectSingleNode(g).text}else{SelectRow.cells(M).firstChild.innerText=""}}if(u=!-1){switch(K.item(0).selectSingleNode("ovflag").text){case"1":SelectRow.cells(u).firstChild.className="SomeCredit";break;case"2":SelectRow.cells(u).firstChild.className="AllCredit";break;case"0":SelectRow.cells(u).firstChild.className="NoCredit";break}}if(J!=-1){switch(K.item(0).selectSingleNode("kasrflag").text){case"1":SelectRow.cells(J).firstChild.className="SomeCredit";break;case"2":SelectRow.cells(J).firstChild.className="AllCredit";break;case"0":SelectRow.cells(J).firstChild.className="NoCredit";break}}}}var DayContinuationRow=null;function OnContextMenuDOW(b){document.getElementById("LinkDiv").style.display="none";DayContinuationRow=window.event.srcElement.parentElement;while(DayContinuationRow.tagName!="TR"){DayContinuationRow=DayContinuationRow.parentElement}var a=window.event.srcElement;while(a.tagName!="TR"){a=a.parentElement}a=a.parentElement;while(a.tagName!="TR"){a=a.parentElement}var d=a.offsetLeft;var c=a.offsetTop;while(a.offsetParent){d=d+a.offsetParent.offsetLeft;c=c+a.offsetParent.offsetTop;if(a==document.getElementsByTagName("body")[0]){break}else{a=a.offsetParent}}document.getElementById("LinkDiv").style.top=c+260;document.getElementById("LinkDiv").style.left=d+350;if(DayContinuationRow.getAttribute("DayContinuation")=="True"||DayContinuationRow.getAttribute("DayContinuation")==1||DayContinuationRow.getAttribute("DayContinuation")==2){document.getElementById("TDDayContinuation").innerHTML=" آيا مايل به حذف مداومت کاري برای تاريخ "+DayContinuationRow.cells(2).innerText+" هستيد؟ ";$get(MasterObj+"txtFlagDayContinuation").value=1}else{document.getElementById("TDDayContinuation").innerHTML=" آيا مايل به ذخيره مداومت کاري برای تاريخ "+DayContinuationRow.cells(2).innerText+" هستيد؟ ";$get(MasterObj+"txtFlagDayContinuation").value=0}document.getElementById("LinkDiv").style.display="inline";return false}function OnClickBtnDailyResult(){if(LastSelectedRow!=""&&LastSelectedRow!=null){var b=document.getElementById(MasterObj+"SDate").value;b=document.getElementById(MasterObj+"SDate").value;EDate=document.getElementById(MasterObj+"EDate").value;var a="DailyResult.aspx?SDate="+b+"&EDate="+EDate+"&SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&PersonCode="+LastSelectedRow.cells(2).innerText;window.showModalDialog(a,"","dialogHeight: 700px;dialogWidth: 1180px;center: Yes;help: no;status: no")}else{alert("لطفا يک سطر از گريد را انتخاب کنيد")}}function OnClickBtnCodeReport(){var a="../BaseInfo/DetailCodeReport.aspx?SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&ReportID="+document.getElementById(MasterObj+"txtReportID").value;window.showModalDialog(a,"","dialogHeight: 600px;dialogWidth: 850px;help: no;resizable:1;status: no;")}function OnClickChk(d){var e="";var h=d.parentElement;while(h.tagName!="TABLE"){h=h.parentElement}var a=d.parentElement;while(a.tagName!="TR"){a=a.parentElement}var c=a.rowIndex;var g=new ActiveXObject("Microsoft.XMLDOM");g.async="false";g.loadXML(strChk);var b=g.documentElement.selectNodes("/Root/Tb [ MID="+h.rows(c).cells(2).innerText+"]");if(b.length>0){g.documentElement.removeChild(b.item(0));strChk=g.xml}else{e+="<Tb>";e+="<MID>"+h.rows(c).cells(2).innerText+"</MID>";e+="<MName>"+h.rows(c).cells(3).innerText+"</MName>";e+="<Type>U</Type>";e+="</Tb>";var f=new ActiveXObject("Microsoft.XMLDOM");f.async="false";f.loadXML("<Root>"+e+"</Root>");var i=f.documentElement.selectSingleNode("/Root/Tb");g.childNodes[0].appendChild(i);strChk=g.xml}}function SetChk(){var e=document.getElementById(MasterObj+"GrdDailyReport");if(e==null){return}var d=e.rows.length-1;var a=new ActiveXObject("Microsoft.XMLDOM");a.async="false";a.loadXML(strChk);var c=a.documentElement.selectNodes("/Root/Tb");var b=c.length;for(var f=0;f<b;f++){for(var g=1;g<d;g++){if(e.rows(g).cells(2).innerText==c.item(f).selectSingleNode("MID").text){e.rows(g).cells(0).firstChild.checked=true}}}}function OnClickBtnModifyCreditGroup(){document.getElementById(MasterObj+"SDate").value=document.getElementById(MasterObj+"KCalSDate_txtYear").value+"/"+document.getElementById(MasterObj+"KCalSDate_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalSDate_txtDay").value;document.getElementById(MasterObj+"EDate").value=document.getElementById(MasterObj+"KCalEDate_txtYear").value+"/"+document.getElementById(MasterObj+"KCalEDate_txtMonth").value+"/"+document.getElementById(MasterObj+"KCalEDate_txtDay").value;var a="../DataEntry/ModifyCreditGroup.aspx?SessionID="+document.getElementById(MasterObj+"txtSessionID").value+"&ToPersonId="+document.getElementById(MasterObj+"txtOnLineUser").value+"&SDate="+document.getElementById(MasterObj+"SDate").value+"&EDate="+document.getElementById(MasterObj+"EDate").value+"&CreditScriptGroup="+$get(MasterObj+"txtScriptGroupXML").value;window.showModalDialog(a,"","dialogHeight:280px;dialogWidth:750px;help: no;resizable:1;status: no;")}function OnBlurtxtCurPage(a){if(a.value!=0&&a.value.replace(" ","")!=""){document.getElementById(MasterObj+"txtCurPage").value=a.value;document.getElementById(MasterObj+"txtSubmit").value="Const";document.getElementById(MasterObj+"BtnSubmit").click()}}function OnClickBtnNext(){document.getElementById(MasterObj+"txtSubmit").value="BtnNext";document.getElementById(MasterObj+"BtnSubmit").click()}function OnClickBtnLast(){document.getElementById(MasterObj+"txtSubmit").value="BtnLast";document.getElementById(MasterObj+"BtnSubmit").click()}function OnClickBtnPrv(){document.getElementById(MasterObj+"txtSubmit").value="BtnPrev";document.getElementById(MasterObj+"BtnSubmit").click()}function OnClickBtnFirst(){document.getElementById(MasterObj+"txtSubmit").value="BtnFirst";document.getElementById(MasterObj+"BtnSubmit").click()}function OnClickBtnAllPDF(){document.getElementById(MasterObj+"txtSubmit").value="AllPDF";document.getElementById(MasterObj+"BtnSubmitSend").click()}function OnClickBtnOnePDF(){document.getElementById(MasterObj+"txtSubmit").value="OnePDF";document.getElementById(MasterObj+"BtnSubmitSend").click()}function OnClickBtnAllExcel(){document.getElementById(MasterObj+"txtSubmit").value="AllExcel";document.getElementById(MasterObj+"BtnSubmitSend").click()}function OnClickBtnOneExcel(){document.getElementById(MasterObj+"txtSubmit").value="OneExcel";document.getElementById(MasterObj+"BtnSubmitSend").click()}function onchangeCmbShift(){document.getElementById(MasterObj+"txtSubmit").value="onchangecmbShift";document.getElementById(MasterObj+"BtnSubmit3").click()}function onchangecmbGroup(){document.getElementById(MasterObj+"txtSubmit").value="onchangecmbGroup";document.getElementById(MasterObj+"BtnSubmit3").click()}Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(BeginRequestHandler);Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);function BeginRequestHandler(b,a){var c=a.get_postBackElement();if($get(MasterObj+"txtSubmit").value=="onchangecmbShift"||$get(MasterObj+"txtSubmit").value=="onchangecmbGroup"){document.getElementById("ctl00_ProgressState").value=1}}function EndRequestHandler(e,d){document.dir="RTL";var b=document.getElementById(MasterObj+"GrdDailyReport");LastSelectedRow=null;var a=0;if(b){a=b.rows.length-1}else{return}if(b!=null){b.rows(a-1).cells(0).innerText="سرجمع";b.rows(a-1).cells(1).innerText="";b.rows(a-1).cells(2).innerText=""}var c=$get(MasterObj+"txtSubmit").value;if(c!=""){SetChk()}if(c=="Calc"){if($get(MasterObj+"txtValidateCalc").value=="1"||$get(MasterObj+"txtValidateCalc").value=="True"){SetMsg($get(MasterObj+"txtAlert").value)}else{alert($get(MasterObj+"txtAlert").value)}}if(c!=""&&c!="RefreshRow"&&c!="DayContinuation"){$get(MasterObj+"txtSubmit").value="";document.getElementById(MasterObj+"txtRowDate").value="";PageLoad()}else{if(c=="RefreshRow"){UpdateRow()}}};