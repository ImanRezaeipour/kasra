var flag=0;$get(MasterObj+"txtName").style.display="inline";DivName.style.display="none";SDateDiv.style.display="inline";DivSDate.style.display="none";EDateDiv.style.display="inline";DivEDate.style.display="none";if(document.getElementById(MasterObj+"txtMode").value=="Edit"||document.getElementById(MasterObj+"txtMode").value=="SetExpire"){document.getElementById("OToolBar_BtnNew").style.visibility="hidden";getDate()}Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(BeginRequestHandler);Sys.WebForms.PageRequestManager.getInstance().add_endRequest(EndRequestHandler);function BeginRequestHandler(b,a){}function EndRequestHandler(c,b){var a=$get(MasterObj+"txtSubmit").value;if(a=="Save"){flag=1;if(document.getElementById(MasterObj+"txtMode").value=="SetExpire"){getDate()}}if($get(MasterObj+"txtAlert").value!=""){SetMsg($get(MasterObj+"txtAlert").value);$get(MasterObj+"txtAlert").value=""}$get(MasterObj+"txtSubmit").value=""}function OnClickBtnCancel(){window.returnValue=flag;window.close()}function OnClickBtnSave(){if(CheckSave()){Save();if($get(MasterObj+"SDate").value>$get(MasterObj+"EDate").value){alert("تاريخ شروع از خاتمه بزرگتر است.")}else{if(document.getElementById(MasterObj+"EXDate").value!=""&&!document.getElementById(MasterObj+"ChkActive").checked){if(confirm("اين دوره در صورت قطعي شدن، اسکريپت هاي نيمه فعال را اجرا نميکند\n آيا مايل به ادامه هستيد؟ ")){document.getElementById(MasterObj+"txtSubmit").value="Save";document.getElementById(MasterObj+"BtnSubmit").click()}}else{document.getElementById(MasterObj+"txtSubmit").value="Save";document.getElementById(MasterObj+"BtnSubmit").click()}}}else{alert("لطفا اطلاعات را کامل کنيد!")}}function OnClickBtnNew(){$get(MasterObj+"txtName").value="";$get(MasterObj+"SDate").value="";$get(MasterObj+"EDate").value="";$get(MasterObj+"KCalSDate_txtYear").value="";$get(MasterObj+"KCalSDate_txtMonth").value="";$get(MasterObj+"KCalSDate_txtDay").value="";$get(MasterObj+"KCalEDate_txtYear").value="";$get(MasterObj+"KCalEDate_txtMonth").value="";$get(MasterObj+"KCalEDate_txtDay").value="";$get(MasterObj+"KCalEXDate_txtYear").value="";$get(MasterObj+"KCalEXDate_txtMonth").value="";$get(MasterObj+"KCalEXDate_txtDay").value="";$get(MasterObj+"KCalEDate_txtCalendar").value="";$get(MasterObj+"KCalSDate_txtCalendar").value="";$get(MasterObj+"KCalEXDate_txtCalendar").value=""}function CheckSave(){if(document.getElementById(MasterObj+"txtMode").value=="New"||document.getElementById(MasterObj+"txtMode").value=="Edit"){if($get(MasterObj+"txtName").value==""){$get(MasterObj+"txtName").focus();return false}if($get(MasterObj+"KCalSDate_txtYear").value==""){$get(MasterObj+"KCalSDate_txtCalendar").focus();return false}if($get(MasterObj+"KCalSDate_txtMonth").value==""){$get(MasterObj+"KCalSDate_txtCalendar").focus();return false}if($get(MasterObj+"KCalSDate_txtDay").value==""){$get(MasterObj+"KCalSDate_txtCalendar").focus();return false}if($get(MasterObj+"KCalEDate_txtYear").value==""){$get(MasterObj+"KCalEDate_txtCalendar").focus();return false}if($get(MasterObj+"KCalEDate_txtMonth").value==""){$get(MasterObj+"KCalEDate_txtCalendar").focus();return false}if($get(MasterObj+"KCalEDate_txtDay").value==""){$get(MasterObj+"KCalEDate_txtCalendar").focus();return false}return true}else{if($get(MasterObj+"KCalEXDate_txtDay").value==""){$get(MasterObj+"KCalEXDate_txtCalendar").focus();return false}return true}}function Save(){if(document.getElementById(MasterObj+"txtMode").value=="Edit"||document.getElementById(MasterObj+"txtMode").value=="New"){$get(MasterObj+"SDate").value=$get(MasterObj+"KCalSDate_txtYear").value+"/"+$get(MasterObj+"KCalSDate_txtMonth").value+"/"+$get(MasterObj+"KCalSDate_txtDay").value;$get(MasterObj+"EDate").value=$get(MasterObj+"KCalEDate_txtYear").value+"/"+$get(MasterObj+"KCalEDate_txtMonth").value+"/"+$get(MasterObj+"KCalEDate_txtDay").value;if($get(MasterObj+"KCalEXDate_txtYear").value!=""&&$get(MasterObj+"KCalEXDate_txtMonth").value&&$get(MasterObj+"KCalEXDate_txtDay").value){$get(MasterObj+"EXDate").value=$get(MasterObj+"KCalEXDate_txtYear").value+"/"+$get(MasterObj+"KCalEXDate_txtMonth").value+"/"+$get(MasterObj+"KCalEXDate_txtDay").value}else{$get(MasterObj+"EXDate").value=""}}else{var a=$get(MasterObj+"SDate").value;$get(MasterObj+"SDate").value=a.substr(6,4)+"/"+a.substr(3,2)+"/"+a.substr(0,2);a=$get(MasterObj+"EDate").value;$get(MasterObj+"EDate").value=a.substr(6,4)+"/"+a.substr(3,2)+"/"+a.substr(0,2);$get(MasterObj+"txtName").value=(DivName.title=="")?DivName.innerText:DivName.title;$get(MasterObj+"EXDate").value=$get(MasterObj+"KCalEXDate_txtYear").value+"/"+$get(MasterObj+"KCalEXDate_txtMonth").value+"/"+$get(MasterObj+"KCalEXDate_txtDay").value}}function getDate(){var a=$get(MasterObj+"SDate").value;if(document.getElementById(MasterObj+"txtMode").value=="Edit"){$get(MasterObj+"KCalSDate_txtYear").value=a.substr(6,4);$get(MasterObj+"KCalSDate_txtMonth").value=a.substr(3,2);$get(MasterObj+"KCalSDate_txtDay").value=a.substr(0,2);$get(MasterObj+"KCalSDate_txtCalendar").value=$get(MasterObj+"KCalSDate_txtDay").value+"/"+$get(MasterObj+"KCalSDate_txtMonth").value+"/"+$get(MasterObj+"KCalSDate_txtYear").value;$get(MasterObj+"KCalSDate_txtCalendar").value=$get(MasterObj+"KCalSDate_txtCalendar").value+"  "+F_adbsghh($get(MasterObj+"KCalSDate_txtDay").value+"/"+$get(MasterObj+"KCalSDate_txtMonth").value+"/"+$get(MasterObj+"KCalSDate_txtYear").value);a=$get(MasterObj+"EDate").value;$get(MasterObj+"KCalEDate_txtYear").value=a.substr(6,4);$get(MasterObj+"KCalEDate_txtMonth").value=a.substr(3,2);$get(MasterObj+"KCalEDate_txtDay").value=a.substr(0,2);$get(MasterObj+"KCalEDate_txtCalendar").value=$get(MasterObj+"KCalEDate_txtDay").value+"/"+$get(MasterObj+"KCalEDate_txtMonth").value+"/"+$get(MasterObj+"KCalEDate_txtYear").value;$get(MasterObj+"KCalEDate_txtCalendar").value=$get(MasterObj+"KCalEDate_txtCalendar").value+"  "+F_adbsghh($get(MasterObj+"KCalEDate_txtDay").value+"/"+$get(MasterObj+"KCalEDate_txtMonth").value+"/"+$get(MasterObj+"KCalEDate_txtYear").value);a=$get(MasterObj+"EXDate").value;if(a!=""){$get(MasterObj+"KCalEXDate_txtYear").value=a.substr(6,4);$get(MasterObj+"KCalEXDate_txtMonth").value=a.substr(3,2);$get(MasterObj+"KCalEXDate_txtDay").value=a.substr(0,2);$get(MasterObj+"KCalEXDate_txtCalendar").value=$get(MasterObj+"KCalEXDate_txtDay").value+"/"+$get(MasterObj+"KCalEXDate_txtMonth").value+"/"+$get(MasterObj+"KCalEXDate_txtYear").value;$get(MasterObj+"KCalEXDate_txtCalendar").value=$get(MasterObj+"KCalEXDate_txtCalendar").value+"  "+F_adbsghh($get(MasterObj+"KCalEXDate_txtDay").value+"/"+$get(MasterObj+"KCalEXDate_txtMonth").value+"/"+$get(MasterObj+"KCalEXDate_txtYear").value)}}else{$get(MasterObj+"txtName").style.display="none";DivName.style.display="inline";SDateDiv.style.display="none";DivSDate.style.display="inline";EDateDiv.style.display="none";DivEDate.style.display="inline";if(flag==0){if($get(MasterObj+"txtName").value.length>10){DivName.innerText=$get(MasterObj+"txtName").value.substr(0,8)+"...";DivName.title=$get(MasterObj+"txtName").value}else{DivName.innerText=$get(MasterObj+"txtName").value}DivSDate.innerText=a;a=$get(MasterObj+"EDate").value;DivEDate.innerText=a;a=$get(MasterObj+"EXDate").value;if(a!=""){$get(MasterObj+"KCalEXDate_txtYear").value=a.substr(6,4);$get(MasterObj+"KCalEXDate_txtMonth").value=a.substr(3,2);$get(MasterObj+"KCalEXDate_txtDay").value=a.substr(0,2);$get(MasterObj+"KCalEXDate_txtCalendar").value=$get(MasterObj+"KCalEXDate_txtDay").value+"/"+$get(MasterObj+"KCalEXDate_txtMonth").value+"/"+$get(MasterObj+"KCalEXDate_txtYear").value;$get(MasterObj+"KCalEXDate_txtCalendar").value=$get(MasterObj+"KCalEXDate_txtCalendar").value+"  "+F_adbsghh($get(MasterObj+"KCalEXDate_txtDay").value+"/"+$get(MasterObj+"KCalEXDate_txtMonth").value+"/"+$get(MasterObj+"KCalEXDate_txtYear").value)}}else{if($get(MasterObj+"txtName").value.length>10){DivName.innerText=$get(MasterObj+"txtName").value.substr(0,8)+"...";DivName.title=$get(MasterObj+"txtName").value}else{DivName.innerText=$get(MasterObj+"txtName").value}DivSDate.innerText=a;DivSDate.innerText=a.substr(8,4)+"/"+a.substr(5,2)+"/"+a.substr(0,4);$get(MasterObj+"SDate").value=a.substr(8,4)+"/"+a.substr(5,2)+"/"+a.substr(0,4);a=$get(MasterObj+"EDate").value;DivEDate.innerText=a;DivEDate.innerText=a.substr(8,4)+"/"+a.substr(5,2)+"/"+a.substr(0,4);$get(MasterObj+"EDate").value=a.substr(8,4)+"/"+a.substr(5,2)+"/"+a.substr(0,4);a=$get(MasterObj+"EXDate").value;if(a!=""){$get(MasterObj+"KCalEXDate_txtYear").value=a.substr(0,4);$get(MasterObj+"KCalEXDate_txtMonth").value=a.substr(5,2);$get(MasterObj+"KCalEXDate_txtDay").value=a.substr(8,2);$get(MasterObj+"KCalEXDate_txtCalendar").value=$get(MasterObj+"KCalEXDate_txtDay").value+"/"+$get(MasterObj+"KCalEXDate_txtMonth").value+"/"+$get(MasterObj+"KCalEXDate_txtYear").value;$get(MasterObj+"KCalEXDate_txtCalendar").value=$get(MasterObj+"KCalEXDate_txtCalendar").value+"  "+F_adbsghh($get(MasterObj+"KCalEXDate_txtDay").value+"/"+$get(MasterObj+"KCalEXDate_txtMonth").value+"/"+$get(MasterObj+"KCalEXDate_txtYear").value)}}}};