var NextObj;function Calendar(a){this.id=a;this.GetYear=___fnGetYear;this.GetMonth=___fnGetMonth;this.GetDay=___fnGetDay;this.SetYear=___fnSetYear;this.SetMonth=___fnSetMonth;this.SetDay=___fnSetDay;document.all.item(this.id+"_MainTable").UserControlID=a}function ___fnGetYear(){return document.all.item(this.id+"_txtYear").value}function ___fnGetMonth(){return document.all.item(this.id+"_txtMonth").value}function ___fnGetDay(){return document.all.item(this.id+"_txtDay").value}function ___fnSetYear(a){document.all.item(this.id+"_txtYear").value=a}function ___fnSetMonth(a){document.all.item(this.id+"_txtMonth").value=a}function ___fnSetDay(a){document.all.item(this.id+"_txtDay").value=a}function OnKeyDownNumInput(){var a=event.keyCode;window.event.returnValue=(((a>=96)&&(a<=105))||((a>=48)&&(a<=57))||(a==8)||(a==9)||(a==46)||((a>=35)&&(a<=40)))}function txtonkeydown(){var c=event.srcElement;var a=GetUserControlID(event.srcElement);var d=event.keyCode;if(d==38){TextDateUserControl_SetDate(a,event.srcElement,"up");return}if(d==40){TextDateUserControl_SetDate(a,event.srcElement,"down");return}if(d==13){if(c.id.search("_txtDay")!=0){ResetDateColor(a);document.all.item(a+"_txtMonth").style.backgroundColor="pink";document.all.item(a+"_txtMonth").focus()}if(c.id==a+"_txtMonth"){ResetDateColor(a);document.all.item(a+"_txtYear").style.backgroundColor="pink";document.all.item(a+"_txtYear").focus()}if(c.id==a+"_txtYear"){ResetDateColor(a);NextObj.focus()}}document.all.item(a+"_txtKeyCodeHid").value=d;OnKeyDownNumInput();var b=new String;b=document.all.item(a+"_tblTextDate").rows(0).children(2).children(0).value}function txtDayonkeyup(){if(event.keyCode==38||event.keyCode==40){return}var a=GetUserControlID(event.srcElement);var b=new String;var c=new Number;b=document.all.item(a+"_tblTextDate").rows(0).children(0).children(0).value;c=b;if(b.length==2&&c!=0&&document.all.item(a+"_txtKeyCodeHid").value!=9){document.all.item(a+"_tblTextDate").rows(0).children(2).children(0).focus()}}function txtMonthonkeyup(){if(event.keyCode==38||event.keyCode==40){return}var a=GetUserControlID(event.srcElement);var b=new String;var c=new Number;b=document.all.item(a+"_tblTextDate").rows(0).children(2).children(0).value;c=b;if(b.length==2&&c!=0&&document.all.item(a+"_txtKeyCodeHid").value!=9){document.all.item(a+"_tblTextDate").rows(0).children(4).children(0).focus()}}function txtonblur(){var a=GetUserControlID(event.srcElement);if(document.all.item(a+"_txtFocusTextsHid").value=="true"&&parseInt(document.all.item(a+"_txtFocusCountHid").value)>1){document.all.item(a+"_txtFocusTextsHid").value=false}else{var b;document.all.item(a+"_txtFocusCountHid").value=0;b=window.event.srcElement.value}}function txtonfocus(){var a=GetUserControlID(event.srcElement);document.all.item(a+"_txtFocusCountHid").value=parseInt(document.all.item(a+"_txtFocusCountHid").value)+1;document.all.item(a+"_txtFocusTextsHid").value=true}function F_GetUserControlID(d){try{var b="";var a=0;while(++a<20&&d!=null&&d.IsMainTable==null){d=d.parentElement}if(d!=null&&d.IsMainTable!=null&&d.IsMainTable=="true"){b=d.UserControlID}return b}catch(c){}}function btnShowCalenderOnClick(){this.UserControlID=F_GetUserControlID(event.srcElement);if(document.getElementById(this.UserControlID+"_txtCalendar").value!=""){var Year=document.getElementById(this.UserControlID+"_txtYear").value;var Month=document.getElementById(this.UserControlID+"_txtMonth").value;var Day=document.getElementById(this.UserControlID+"_txtDay").value}else{obj=document.getElementById(this.UserControlID+"_txtDateNow").value;var Year=obj.substr(0,4);var Month=obj.substr(5,2);var Day=obj.substr(8,2)}var oCurrentDate=new Object();oCurrentDate.Year=Year;oCurrentDate.Month=Month;oCurrentDate.Day=Day;oCurrentDate.Holiday=document.all.item(this.UserControlID+"_txtXmlHoliday").value;var strFeature="dialogHeight:266px;dialogWidth:277px;dialogLeft:200px;dialogTop:200px;status=no";var strUrl="/TAPresentation/App_Utility/NewCalendar/SolarCalendar.htm";var oDate=showModalDialog(strUrl,oCurrentDate,strFeature);var strYear="";var strMonth="";var strDay="";if(oDate!=null){var strYear=oDate.Year;var strMonth=((parseInt(oDate.Month,10)<10)?"0"+parseInt(oDate.Month,10).toString():oDate.Month.toString());var strDay=((parseInt(oDate.Day,10)<10)?"0"+parseInt(oDate.Day,10).toString():oDate.Day.toString())}Year=strYear;Month=strMonth;Day=strDay;document.getElementById(this.UserControlID+"_txtDay").value=Day;document.getElementById(this.UserControlID+"_txtMonth").value=Month;document.getElementById(this.UserControlID+"_txtYear").value=Year;document.getElementById(this.UserControlID+"_txtCalendar").value=document.getElementById(this.UserControlID+"_txtDay").value+"/"+document.getElementById(this.UserControlID+"_txtMonth").value+"/"+document.getElementById(this.UserControlID+"_txtYear").value;document.getElementById(this.UserControlID+"_txtCalendar").value=document.getElementById(this.UserControlID+"_txtCalendar").value+"  "+F_adbsghh(document.getElementById(this.UserControlID+"_txtDay").value+"/"+document.getElementById(this.UserControlID+"_txtMonth").value+"/"+document.getElementById(this.UserControlID+"_txtYear").value);eval(document.all.item(this.UserControlID+"_txtOnChangeFunc").value);return}function GetUserControlID(c){var b="";var a=0;while(++a<20&&c!=null&&c.IsMainTable==null){c=c.parentElement}if(c!=null&&c.IsMainTable!=null&&c.IsMainTable=="true"){b=c.UserControlID}return b}function TextDateUserControl_SetDate(n,h,a){var e=document.all.item(n+"_txtYear");if(isNaN(parseInt(e.value,10))||parseInt(e.value,10)<1300||parseInt(e.value,10)>1500){return}else{var l=parseInt(e.value,10)}var g=document.all.item(n+"_txtMonth");if(isNaN(parseInt(g.value,10))||parseInt(g.value,10)<1||parseInt(g.value,10)>12){return}else{var i=parseInt(g.value,10)}var k=document.all.item(n+"_txtDay");if(isNaN(parseInt(k.value,10))||parseInt(k.value,10)<1||parseInt(k.value,10)>31){return}else{var d=parseInt(k.value,10)}var b=new KasraDate();var p=h.DatePartintion;var c;if(a=="up"){switch(p){case"Year":c=b.PersianDateAdd(l,i,d,1,0);break;case"Month":c=b.PersianDateAdd(l,i,d,1,1);break;case"Day":c=b.PersianDateAdd(l,i,d,1,2);break}}else{switch(p){case"Year":c=b.PersianDateAdd(l,i,d,-1,0);break;case"Month":c=b.PersianDateAdd(l,i,d,-1,1);break;case"Day":c=b.PersianDateAdd(l,i,d,-1,2);break}}var f=c[0].toString().length;for(var j=4;j>f;j--){c[0]="0"+c[0]}var m=c[1].toString().length;for(j=2;j>m;j--){c[1]="0"+c[1]}var o=c[2].toString().length;for(j=2;j>o;j--){c[2]="0"+c[2]}e.value=c[0];g.value=c[1];k.value=c[2];return}function SetObjAfterDate(a){NextObj=a}function ResetDateColor(a){document.all.item(a+"_txtDay").style.backgroundColor="";document.all.item(a+"_txtMonth").style.backgroundColor="";document.all.item(a+"_txtYear").style.backgroundColor=""};